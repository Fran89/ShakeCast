<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/images/sc_logo.png">

    <title>ShakeCast</title>

    <!-- Bootstrap core CSS -->
    <link href="./bootstrap3/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
	<link rel="stylesheet" href="./bootstrap3/css/navbar-fixed-top.css">
	<link rel="stylesheet" href="./css/main.css">
    <!-- <link rel="stylesheet" href="./css/docs.css"> -->

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
  <!-- Fixed navbar -->
  <div class="navbar navbar-default navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
	<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	  <span class="sr-only">Toggle navigation</span>
	  <span class="icon-bar"></span>
	  <span class="icon-bar"></span>
	  <span class="icon-bar"></span>
	</button>
	<a class="navbar-brand" href="./index.html"><img src="/images/sc_logo.png" class="img-circle logo" /> ShakeCast</a>
      </div>
      <div class="navbar-collapse collapse">
	<ul id="nav_menu" class="nav navbar-nav">
	  <li class="active"><a href="./index.html">Home</a></li>
	  <li><a href="#about">About</a></li>
	  <li class="dropdown">
	  <a href="./list.html" class="dropdown-toggle" data-toggle="dropdown">Earthquake List <b class="caret"></b></a>
	  <ul class="dropdown-menu">
	    <li><a href="./list.html">Recent Events</a></li>
	    <li class="divider"></li>
	    <li><a href="./list.html?type=major">Significant Events</a></li>
	    <li><a href="./list.html?type=scenario">Scenarios</a></li>
	    <li class="divider"></li>
	  </ul>
	  </li>
	    <li><a href="./preference.html">Settings</a></li>
	</ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>

  <!-- Subhead
  ================================================== -->
  <header class="header" id="overview">
    <div class="container">
      <h2>Earthquake Overview <small>Recent earthquake activities and ShakeCast summary</small></h2>
    </div>
  </header>
  
  
  <div class="container">
  
    <!-- Main hero unit for a primary marketing message or call to action -->
    <div class="jumbotron" style="padding: 30px;">
    <div id="map_title"></div>
    <div id="map_canvas" style="width:800px; height:400px;"></div>
    <div id="caption"></div>
    <button id="fullscreen" class="btn btn-default">Enter Fullscreen Mode</button>
    <button id="last_event" class="btn btn-default">Previous Event</button>
    <button id="next_event" class="btn btn-default">Next Event</button>
    </div>
  
    <!-- Example row of columns -->
    <div class="row">
      <div class="col-md-4">
	<h3>ShakeMap Archive</h3>
	<p>ShakeMap is a product of the U.S. Geological Survey Earthquake Hazards Program in conjunction with regional seismic network operators. ShakeMap sites provide near-real-time maps of ground motion and shaking intensity following significant earthquakes. These maps are used by federal, state, and local organizations, both public and private, for post-earthquake response and recovery, public and scientific information, as well as for preparedness exercises and disaster planning.</p>
	<p><a class="btn btn-default" href="list.html">View Archive &raquo;</a> <a class="btn btn-default" href="list.html?type=scenario">View Scenario &raquo;</a></p>
      </div>
      <div class="col-md-4">
	<h3>Scientific Background</h3>
	<p>
	  ShakeCast, short for ShakeMap Broadcast, is a fully automated, freely-available open-source system for delivering specific ShakeMap products to critical users and for triggering established post-earthquake response protocols.
	 <br>
	 <br>
	  ShakeCast allows utilities, transportation agencies, and other large organizations to automatically determine the shaking value at their facilities, set thresholds for notification of damage states (typically green, yellow, and red) for each facility and then automatically notify (via pager, cell phone, or email) specified operators, inspectors, and others within their organizations responsible for those particular facilities in order to prioritize inspection and response.
	<p><a class="btn btn-default" href="#">View details &raquo;</a></p>
	 </p>
      </div>
      <div class="col-md-4">
	<h3>Product Formats</h3>
	<p><a class="btn btn-default" type="button"  href="http://earthquake.usgs.gov/research/shakemap/formats.php"><i class="icon-info-sign"></i> ShakeMap Product Formats</a></p>			
	<blockquote>
	<p class="lead">ShakeCast Product Formats</p>
	<dl>
	<dt>Facility List</dt>
	<dd>
	A table of earthquake and station parameters, formatted to be read easily by humans. An XML formatted file is also available, and is the best option for parsing the information by computer.
	The station information includes name and/or code, location coordinates, and peak velocity and acceleration values.
	</dd>
	</dl>
	</p>
	</blockquote>
	<p><a class="btn btn-default" href="#">View details &raquo;</a></p>
      </div>
      <div class="col-md-4">
	<h3>Related Resources</h3>
	<p>
	<a class="btn btn-default" type="button"  href="http://earthquake.usgs.gov/research/shakemap/"><i class="icon-info-sign"></i> ShakeMap Research Project</a>
	<a class="btn btn-default btn-primary" type="button"  href="https://www.sciencebase.gov/confluence/display/ShakeCast/Home"><i class="icon-folder-open icon-white"></i> ShakeCast Wiki</a>
	</p>
      </div>
    </div>
  
    <div id="spinner" class="spinner ui-widget ui-widget-content ui-corner-all" style="width:50px;background:#fff;height:50px;">
      <img id="img-spinner" src="/images/usgs.gif" alt="Loading" style="margin:10px auto;"/>
    </div>
  
  </div> <!-- /container -->

    <!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <ul class="footer-links">
          <li><a href="http://earthquake.usgs.gov">&copy; USGS 2013</a></li>
          <li class="muted">&middot;</li>
          <li>Desktop</li>
          <li class="muted">&middot;</li>
          <li><a href="/html/mobile.html">Mobile</a></li>
        </ul>
     </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="./bootstrap3/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/jquery.fullscreen-min.js"></script>
    <script type="text/javascript" src="./js/main.js"></script>
    <script type="text/javascript" src="/js/shakemap.js"></script>
    <script type="text/javascript" src="/js/loadXML.js"></script>
    <script type="text/javascript" src="./js/mapapp_list.js"></script>
    <script type="text/javascript" src="./js/sc_constant.js"></script>
    <script type="text/javascript" src="/js/storage.js"></script>

	<script>
		var map;
		var fac_des = [];
		var event_ind;
		var display_ind=0;
		var max_list = 5;
		var event_array = [];
		var age;
		var latlng = new google.maps.LatLng(35,-120);

	$(window).load(function() {
		SC_DEF.init();
		map = MAPAPP.init(SC_DEF);
			//google.maps.event.trigger(map, 'resize');
		$(window).trigger('resize');

		refresh_list();
		if (SC_DEF.slideshow_flag) {
			setInterval(switch_sm, parseFloat(SC_DEF.event_int)*60000);
		}
		setInterval(refresh_list, parseFloat(SC_DEF.refresh_int)*60000);
		menu_update();
	});

	function refresh_list(){
		//var sm_url = '/scripts/shakemap.pl/from_id/' + sc_id;
		var type = SC_DEF.event_type ? SC_DEF.event_type : 'actual';
		 age = SC_DEF.recent_events ? parseInt(SC_DEF.recent_events) : '7';
		//var sm_url = '/scripts/event.pl/event_list?type='+type+'&age='+age;
		var sm_url = '/scripts/r/event/event_list?type='+type+'&age='+age;

		$.getJSON(sm_url, function(data) {

			// Are there even any EQ to display?
			if (data.length <= 0) {
				return;
			}

			var eqTable = [];
			event_ind = data.length;
			event_array = data.slice();
			for (var i=0; i < data.length; i++) {
			//MAPAPP.addMarker(data.facility_damage[key]);
			var event = data[i];
			event.opacity = 1-i/data.length;
			MAPAPP.addMarker(event);
			}

			if (display_ind == 0) switch_sm();
		});

	}

	function switch_sm(){
		var event = event_array[display_ind];
		var shakemap = event.shakemap_id + '-' + event.shakemap_version;
		//var dmg_url = '/scripts/damage.pl/from_id/'+shakemap+'?action=summary';
		var dmg_url = '/scripts/r/damage/from_id/'+shakemap+'?action=summary';
		    $("#map_title").html('<p class="text-info">Loading Event ' + shakemap +
					' (' + (display_ind+1) + '/' + event_ind + ' for the last ' +
					age + ' days)...</p>');
		if (!SC_DEF.fixed_pos_flag) {
		    google.maps.event.trigger(MAPAPP.facMarkers[event.event_id], 'click');
		    map.setCenter(MAPAPP.facMarkers[event.event_id].getPosition());
		}
		display_ind ++;
		if (display_ind >= event_ind) {display_ind = 0;}
	}

	$(window).resize(function() {
		//$("#eq_content_table").width($(".row").width());
		$("#map_canvas").width($(".jumbotron").width());
		if ($(".jumbotron").fullScreen()) {
		$("#map_canvas").height($(".jumbotron").height()-40);
		} else {
		$("#map_canvas").height(($("#map_canvas").width())/2);
		}
		//console.log($("#map_canvas").width());
		google.maps.event.trigger(map, 'resize');
		var cont_height = $("#map_canvas").height() + $(".row").height();
		$('html').css('height', cont_height+ 300);
	});

      $('#fullscreen').on('click', function() {
	  var elem = $(".jumbotron");
	    elem.fullScreen(true);
      });
      $('#next_event').on('click', function() {
	switch_sm();
      });
      $('#last_event').on('click', function() {
	display_ind = display_ind-2;
	display_ind = (display_ind < 0) ? event_ind+display_ind : display_ind;
	switch_sm();
      });

    </script>

  </body>
</html>
